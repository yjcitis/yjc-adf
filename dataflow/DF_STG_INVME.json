{
	"name": "DF_STG_INVME",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ERP_INVME",
						"type": "DatasetReference"
					},
					"name": "ERPINVME"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "STG_INVME",
						"type": "DatasetReference"
					},
					"name": "sink1INVME"
				},
				{
					"dataset": {
						"referenceName": "STG_INVME",
						"type": "DatasetReference"
					},
					"name": "sink2INVME"
				},
				{
					"dataset": {
						"referenceName": "STG_INVME_EXC",
						"type": "DatasetReference"
					},
					"name": "sink3INVMEEXC"
				}
			],
			"transformations": [
				{
					"name": "split1"
				},
				{
					"name": "alterRow1"
				},
				{
					"name": "alterRow2"
				},
				{
					"name": "alterRow3"
				}
			],
			"scriptLines": [
				"source(output(",
				"          COMPANY as string,",
				"          CREATOR as string,",
				"          USR_GROUP as string,",
				"          CREATE_DATE as string,",
				"          MODIFIER as string,",
				"          MODI_DATE as string,",
				"          FLAG as decimal(3,0),",
				"          CREATE_TIME as string,",
				"          MODI_TIME as string,",
				"          TRANS_TYPE as string,",
				"          TRANS_NAME as string,",
				"          sync_date as string,",
				"          sync_time as string,",
				"          sync_mark as string,",
				"          sync_count as decimal(3,0),",
				"          DataUser as string,",
				"          DataGroup as string,",
				"          ME001 as string,",
				"          ME002 as string,",
				"          ME003 as date,",
				"          ME004 as date,",
				"          ME005 as string,",
				"          ME006 as string,",
				"          ME007 as string,",
				"          ME008 as string,",
				"          ME009 as string,",
				"          ME010 as date,",
				"          ME011 as decimal(21,6),",
				"          ME012 as decimal(15,6),",
				"          ME013 as string,",
				"          ME014 as string,",
				"          ME015 as string,",
				"          ME016 as string,",
				"          ME017 as string,",
				"          ME018 as string,",
				"          ME019 as decimal(16,3),",
				"          ME020 as decimal(16,3),",
				"          ME021 as decimal(13,4),",
				"          ME022 as string,",
				"          ME023 as string,",
				"          ME024 as string,",
				"          ME025 as string,",
				"          ME026 as decimal(21,6),",
				"          ME027 as decimal(21,6),",
				"          ME028 as decimal(11,3),",
				"          ME029 as decimal(11,3),",
				"          ME030 as string,",
				"          ME031 as string,",
				"          ME032 as string,",
				"          ME033 as string,",
				"          ME034 as string,",
				"          ME035 as string,",
				"          UDF01 as string,",
				"          UDF02 as string,",
				"          UDF03 as string,",
				"          UDF04 as string,",
				"          UDF05 as string,",
				"          UDF06 as decimal(21,6),",
				"          UDF07 as decimal(21,6),",
				"          UDF08 as decimal(21,6),",
				"          UDF09 as decimal(21,6),",
				"          UDF10 as decimal(21,6),",
				"          ETL_DATE as timestamp",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     enableNativeCdc: true,",
				"     netChanges: true,",
				"     skipInitialLoad: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> ERPINVME",
				"ERPINVME split(isDate(ME009,'yyyyMMdd') == true(),",
				"     isNull(ME009) == true() || length(ME009) == 0,",
				"     disjoint: false) ~> split1@(ME009OK, ME009Null, ME009NG)",
				"split1@ME009OK alterRow(upsertIf(true())) ~> alterRow1",
				"split1@ME009Null alterRow(upsertIf(true())) ~> alterRow2",
				"split1@ME009NG alterRow(deleteIf(true())) ~> alterRow3",
				"alterRow1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          COMPANY as string,",
				"          CREATOR as string,",
				"          USR_GROUP as string,",
				"          CREATE_DATE as string,",
				"          MODIFIER as string,",
				"          MODI_DATE as string,",
				"          FLAG as decimal(3,0),",
				"          CREATE_TIME as string,",
				"          MODI_TIME as string,",
				"          TRANS_TYPE as string,",
				"          TRANS_NAME as string,",
				"          sync_date as string,",
				"          sync_time as string,",
				"          sync_mark as string,",
				"          sync_count as decimal(3,0),",
				"          DataUser as string,",
				"          DataGroup as string,",
				"          ME001 as string,",
				"          ME002 as string,",
				"          ME003 as date,",
				"          ME004 as date,",
				"          ME005 as string,",
				"          ME006 as string,",
				"          ME007 as string,",
				"          ME008 as string,",
				"          ME009 as string,",
				"          ME010 as date,",
				"          ME011 as decimal(21,6),",
				"          ME012 as decimal(15,6),",
				"          ME013 as string,",
				"          ME014 as string,",
				"          ME015 as string,",
				"          ME016 as string,",
				"          ME017 as string,",
				"          ME018 as string,",
				"          ME019 as decimal(16,3),",
				"          ME020 as decimal(16,3),",
				"          ME021 as decimal(13,4),",
				"          ME022 as string,",
				"          ME023 as string,",
				"          ME024 as string,",
				"          ME025 as string,",
				"          ME026 as decimal(21,6),",
				"          ME027 as decimal(21,6),",
				"          ME028 as decimal(11,3),",
				"          ME029 as decimal(11,3),",
				"          ME030 as string,",
				"          ME031 as string,",
				"          ME032 as string,",
				"          ME033 as string,",
				"          ME034 as string,",
				"          ME035 as string,",
				"          UDF01 as string,",
				"          UDF02 as string,",
				"          UDF03 as string,",
				"          UDF04 as string,",
				"          UDF05 as string,",
				"          UDF06 as decimal(21,6),",
				"          UDF07 as decimal(21,6),",
				"          UDF08 as decimal(21,6),",
				"          UDF09 as decimal(21,6),",
				"          UDF10 as decimal(21,6),",
				"          ETL_DATE as timestamp",
				"     ),",
				"     deletable:true,",
				"     insertable:false,",
				"     updateable:false,",
				"     upsertable:true,",
				"     keys:['COMPANY','ME001','ME002'],",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError',",
				"     outputRejectedData: true) ~> sink1INVME",
				"alterRow2 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          COMPANY as string,",
				"          CREATOR as string,",
				"          USR_GROUP as string,",
				"          CREATE_DATE as string,",
				"          MODIFIER as string,",
				"          MODI_DATE as string,",
				"          FLAG as decimal(3,0),",
				"          CREATE_TIME as string,",
				"          MODI_TIME as string,",
				"          TRANS_TYPE as string,",
				"          TRANS_NAME as string,",
				"          sync_date as string,",
				"          sync_time as string,",
				"          sync_mark as string,",
				"          sync_count as decimal(3,0),",
				"          DataUser as string,",
				"          DataGroup as string,",
				"          ME001 as string,",
				"          ME002 as string,",
				"          ME003 as date,",
				"          ME004 as date,",
				"          ME005 as string,",
				"          ME006 as string,",
				"          ME007 as string,",
				"          ME008 as string,",
				"          ME009 as string,",
				"          ME010 as date,",
				"          ME011 as decimal(21,6),",
				"          ME012 as decimal(15,6),",
				"          ME013 as string,",
				"          ME014 as string,",
				"          ME015 as string,",
				"          ME016 as string,",
				"          ME017 as string,",
				"          ME018 as string,",
				"          ME019 as decimal(16,3),",
				"          ME020 as decimal(16,3),",
				"          ME021 as decimal(13,4),",
				"          ME022 as string,",
				"          ME023 as string,",
				"          ME024 as string,",
				"          ME025 as string,",
				"          ME026 as decimal(21,6),",
				"          ME027 as decimal(21,6),",
				"          ME028 as decimal(11,3),",
				"          ME029 as decimal(11,3),",
				"          ME030 as string,",
				"          ME031 as string,",
				"          ME032 as string,",
				"          ME033 as string,",
				"          ME034 as string,",
				"          ME035 as string,",
				"          UDF01 as string,",
				"          UDF02 as string,",
				"          UDF03 as string,",
				"          UDF04 as string,",
				"          UDF05 as string,",
				"          UDF06 as decimal(21,6),",
				"          UDF07 as decimal(21,6),",
				"          UDF08 as decimal(21,6),",
				"          UDF09 as decimal(21,6),",
				"          UDF10 as decimal(21,6),",
				"          ETL_DATE as timestamp",
				"     ),",
				"     deletable:true,",
				"     insertable:false,",
				"     updateable:false,",
				"     upsertable:true,",
				"     keys:['COMPANY','ME001','ME002'],",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError') ~> sink2INVME",
				"alterRow3 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          COMPANY as string,",
				"          CREATOR as string,",
				"          USR_GROUP as string,",
				"          CREATE_DATE as string,",
				"          MODIFIER as string,",
				"          MODI_DATE as string,",
				"          FLAG as decimal(3,0),",
				"          CREATE_TIME as string,",
				"          MODI_TIME as string,",
				"          TRANS_TYPE as string,",
				"          TRANS_NAME as string,",
				"          sync_date as string,",
				"          sync_time as string,",
				"          sync_mark as string,",
				"          sync_count as decimal(3,0),",
				"          DataUser as string,",
				"          DataGroup as string,",
				"          ME001 as string,",
				"          ME002 as string,",
				"          ME003 as date,",
				"          ME004 as date,",
				"          ME005 as string,",
				"          ME006 as string,",
				"          ME007 as string,",
				"          ME008 as string,",
				"          ME009 as string,",
				"          ME010 as date,",
				"          ME011 as decimal(21,6),",
				"          ME012 as decimal(15,6),",
				"          ME013 as string,",
				"          ME014 as string,",
				"          ME015 as string,",
				"          ME016 as string,",
				"          ME017 as string,",
				"          ME018 as string,",
				"          ME019 as decimal(16,3),",
				"          ME020 as decimal(16,3),",
				"          ME021 as decimal(13,4),",
				"          ME022 as string,",
				"          ME023 as string,",
				"          ME024 as string,",
				"          ME025 as string,",
				"          ME026 as decimal(21,6),",
				"          ME027 as decimal(21,6),",
				"          ME028 as decimal(11,3),",
				"          ME029 as decimal(11,3),",
				"          ME030 as string,",
				"          ME031 as string,",
				"          ME032 as string,",
				"          ME033 as string,",
				"          ME034 as string,",
				"          ME035 as string,",
				"          UDF01 as string,",
				"          UDF02 as string,",
				"          UDF03 as string,",
				"          UDF04 as string,",
				"          UDF05 as string,",
				"          UDF06 as decimal(21,6),",
				"          UDF07 as decimal(21,6),",
				"          UDF08 as decimal(21,6),",
				"          UDF09 as decimal(21,6),",
				"          UDF10 as decimal(21,6),",
				"          ETL_DATE as timestamp",
				"     ),",
				"     deletable:true,",
				"     insertable:false,",
				"     updateable:false,",
				"     upsertable:true,",
				"     keys:['COMPANY','ME001','ME002'],",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError') ~> sink3INVMEEXC"
			]
		}
	}
}